<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Recruitment Position Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="d-flex">
<div th:replace="admin/sidebar.html"></div>
<div class="container my-5">
    <div class="card shadow mb-4">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h1 class="h4">V·ªã tr√≠ tuy·ªÉn d·ª•ng</h1>
                <button type="button" class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#addPositionModal">Th√™m v·ªã tr√≠</button>
            </div>
            <form th:action="@{/admin/recruitment-position}" method="get" class="d-flex justify-content-end mb-3">
                <input type="text" name="keyword" th:value="${keyword}" class="form-control w-25" placeholder="T√¨m ki·∫øm...">
                <button type="submit" class="btn btn-outline-secondary ms-2">üîç</button>
            </form>
        </div>
    </div>

    <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
        <p th:text="${errorMessage}"></p>
    </div>

    <div class="card shadow">
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead class="table-light">
                <tr>
                    <th>STT</th>
                    <th>T√™n v·ªã tr√≠</th>
                    <th>M·ª©c l∆∞∆°ng</th>
                    <th>Kinh nghi·ªám</th>
                    <th>C√¥ng ngh·ªá</th>
                    <th>Ng√†y t·∫°o</th>
                    <th>Thao t√°c</th>
                </tr>
                </thead>
                <tbody th:each="pos, iter : ${positions}">
                <tr>
                    <td th:text="${iter.index + 1}"></td>
                    <td th:text="${pos.name}"></td>
                    <td th:text="${pos.minSalary} + ' - ' + ${pos.maxSalary} + ' VND'"></td>
                    <td th:text="${pos.minExperience} + ' nƒÉm'"></td>
                    <td>
                        <div class="d-flex flex-wrap gap-1">
                            <span th:each="tech : ${pos.technologies}" th:text="${tech}" class="badge bg-warning text-dark"></span>
                        </div>
                    </td>
                    <td th:text="${pos.createdDate}"></td>
                    <td>
                        <a th:href="@{'/admin/recruitment-position'(id=${pos.id})}" class="btn btn-warning btn-sm">‚úèÔ∏è</a>
                        <button type="button" class="btn btn-danger btn-sm" th:onclick="'confirmDelete(' + ${pos.id} + ')'"><span>üóëÔ∏è</span></button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div th:if="${totalItems > 0}" class="d-flex justify-content-between align-items-center p-3 border-top">
            <span>
                Hi·ªÉn th·ªã trang <span th:text="${currentPage + 1}"></span> / <span th:text="${totalPages}"></span> ‚Äî T·ªïng: <span th:text="${totalItems}"></span> v·ªã tr√≠
            </span>
            <nav>
                <ul class="pagination mb-0">
                    <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                        <a class="page-link" th:href="@{'/admin/recruitment-position'(page=${currentPage - 1}, size=${pageSize}, keyword=${keyword})}">&laquo;</a>
                    </li>
                    <li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages - 1)}" th:classappend="${i == currentPage} ? 'active'">
                        <a class="page-link" th:href="@{'/admin/recruitment-position'(page=${i}, size=${pageSize}, keyword=${keyword})}" th:text="${i + 1}"></a>
                    </li>
                    <li class="page-item" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
                        <a class="page-link" th:href="@{'/admin/recruitment-position'(page=${currentPage + 1}, size=${pageSize}, keyword=${keyword})}">&raquo;</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

<!-- Modal Th√™m V·ªã Tr√≠ -->
<div class="modal fade" id="addPositionModal" tabindex="-1" aria-labelledby="addPositionModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form th:action="@{/admin/recruitment-position/save}" method="post" th:object="${position}">
                <div class="modal-header">
                    <h5 class="modal-title">Th√™m v·ªã tr√≠ tuy·ªÉn d·ª•ng</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" th:field="*{id}">
                    <div class="mb-3">
                        <label class="form-label">T√™n v·ªã tr√≠</label>
                        <input type="text" th:field="*{name}" class="form-control">
                        <div class="text-danger" th:errors="*{name}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">M√¥ t·∫£</label>
                        <textarea th:field="*{description}" class="form-control"></textarea>
                        <div class="text-danger" th:errors="*{description}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">L∆∞∆°ng t·ªëi thi·ªÉu</label>
                        <input type="number" th:field="*{minSalary}" class="form-control">
                        <div class="text-danger" th:errors="*{minSalary}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">L∆∞∆°ng t·ªëi ƒëa</label>
                        <input type="number" th:field="*{maxSalary}" class="form-control">
                        <div class="text-danger" th:errors="*{maxSalary}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Kinh nghi·ªám</label>
                        <input type="number" th:field="*{minExperience}" class="form-control">
                        <div class="text-danger" th:errors="*{minExperience}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Ng√†y h·∫øt h·∫°n</label>
                        <input type="date" th:field="*{expiredDate}" class="form-control">
                        <div class="text-danger" th:errors="*{expiredDate}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">C√¥ng ngh·ªá</label>
                        <div class="form-check" th:each="tech : ${technologies}">
                            <input class="form-check-input" type="checkbox" th:value="${tech}" th:field="*{technologies}">
                            <label class="form-check-label" th:text="${tech}"></label>
                        </div>
                        <div class="text-danger" th:errors="*{technologies}"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">L∆∞u</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal S·ª≠a V·ªã Tr√≠ -->
<div class="modal fade" id="editPositionModal" tabindex="-1" aria-labelledby="editPositionModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form th:action="@{/admin/recruitment-position/save}" method="post" th:object="${position}">
                <div class="modal-header">
                    <h5 class="modal-title">C·∫≠p nh·∫≠t v·ªã tr√≠ tuy·ªÉn d·ª•ng</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" th:field="*{id}">
                    <div class="mb-3">
                        <label class="form-label">T√™n v·ªã tr√≠</label>
                        <input type="text" th:field="*{name}" class="form-control">
                        <div class="text-danger" th:errors="*{name}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">M√¥ t·∫£</label>
                        <textarea th:field="*{description}" class="form-control"></textarea>
                        <div class="text-danger" th:errors="*{description}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">L∆∞∆°ng t·ªëi thi·ªÉu</label>
                        <input type="number" th:field="*{minSalary}" class="form-control">
                        <div class="text-danger" th:errors="*{minSalary}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">L∆∞∆°ng t·ªëi ƒëa</label>
                        <input type="number" th:field="*{maxSalary}" class="form-control">
                        <div class="text-danger" th:errors="*{maxSalary}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Kinh nghi·ªám</label>
                        <input type="number" th:field="*{minExperience}" class="form-control">
                        <div class="text-danger" th:errors="*{minExperience}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Ng√†y h·∫øt h·∫°n</label>
                        <input type="date" th:field="*{expiredDate}" class="form-control">
                        <div class="text-danger" th:errors="*{expiredDate}"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">C√¥ng ngh·ªá</label>
                        <div class="form-check" th:each="tech : ${technologies}">
                            <input class="form-check-input" type="checkbox" th:value="${tech}" th:field="*{technologies}">
                            <label class="form-check-label" th:text="${tech}"></label>
                        </div>
                        <div class="text-danger" th:errors="*{technologies}"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">L∆∞u thay ƒë·ªïi</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal X√≥a -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form th:action="@{/admin/recruitment-position/delete}" method="post">
                <div class="modal-header">
                    <h5 class="modal-title">X√°c nh·∫≠n x√≥a</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a v·ªã tr√≠ n√†y kh√¥ng?</p>
                    <input type="hidden" name="id" id="deleteId">
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger">X√≥a</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    let openAdd = [[${openAddModal}]];
    if (openAdd) {
        new bootstrap.Modal(document.getElementById('addPositionModal')).show();
    }

    let openEdit = [[${openEditModal}]];
    if (openEdit) {
        new bootstrap.Modal(document.getElementById('editPositionModal')).show();
    }

    function confirmDelete(id) {
        document.getElementById('deleteId').value = id;
        new bootstrap.Modal(document.getElementById('confirmDeleteModal')).show();
    }
    /*]]>*/
</script>
</body>
</html>
